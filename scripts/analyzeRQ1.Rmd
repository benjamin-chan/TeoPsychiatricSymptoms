# Research Question 1

**Is perceived social support received from Facebook (FMSS) associated with lower rates of**

* Positive screens for psychiatric disorders
  * PC-PTSD
  * PHQ-2
  * AUDIT-C
* Positive screen for suicidality?
  * DSI-SS


## Unadjusted comparisons

```{r}
align <- "llcccccc"
digits <- c(0, 0, 1, 1, 0, 0, 0, 0)
df0 %>% means2Group("fmss", "indPTSD") %>% kable(align = align, digits = digits)
```

\newline

```{r}
df0 %>% means2Group("fmss", "indPHQ") %>% kable(align = align, digits = digits)
```

\newline

```{r}
df0 %>% means2Group("fmss", "indAuditC") %>% kable(align = align, digits = digits)
```

\newline

```{r}
df0 %>% means2Group("fmss", "indDSISS") %>% kable(align = align, digits = digits)
```

\newline

```{r plot2GroupsRQ1}
df0 %>% 
  select(record_id, fmss, indPTSD, indPHQ, indAuditC, indDSISS) %>% 
  gather(key = variable, value = value, -record_id, -fmss) %>% 
  filter(!is.na(value) & !is.na(fmss)) %>% 
  mutate(variable = case_when(variable == "indPTSD" ~ "PC-PTSD",
                              variable == "indPHQ" ~ "PHQ-2",
                              variable == "indAuditC" ~ "AUDIT-C",
                              variable == "indDSISS" ~ "DSI-SS")) %>% 
  mutate(variable = factor(variable, levels = c("PC-PTSD", "PHQ-2", "AUDIT-C", "DSI-SS"))) %>% 
  mutate(value = factor(value, levels = c(FALSE, TRUE), labels = c("Negative", "Positive"))) %>% 
  ggplot() +
  ggtitle("Psychiatric symptoms by\nModified Facebook Measure of Social Support") +
  aes(x = value, y = fmss, color = value, fill = value) +
  geom_violin(alpha = 1/1) +
  scale_x_discrete("") +
  scale_y_continuous("FMSS") +
  scale_color_brewer(palette = "Set1") + 
  scale_fill_brewer(palette = "Set1") +
  facet_wrap(~ variable) +
  theme(legend.position = "none",
        plot.title = element_text(hjust = 0.5))
```


## Adjusted comparisons

```{r}
x <- "fmss"
covar <- c("countSocialMediaExclFB",
           "comm_inperson",
           "indSuicideConsideredEver",
           "countSuicideAttempts")
```

Filter subjects with missing covariates.

```{r}
df1 <-
  df0 %>% 
  select_(.dots = c("record_id", covar)) %>% 
  na.omit() %>% 
  select(record_id) %>% 
  merge(., df0, by = "record_id")
```


### PC-PTSD

```{r}
y <- "indPTSD"
M0 <- fitModel(df1, y, x)
table0 <- M0[["modelObject"]] %>% tidy(exponentiate = TRUE) %>% mutate(model = "Unadjusted") %>% select(model, everything())
M <- fitModel(df1, y, x, covar)
table1 <- M[["modelObject"]] %>% tidy(exponentiate = TRUE) %>% mutate(model = "Adjusted") %>% select(model, everything())
bind_rows(table0, table1) %>% rename(oddsratio = estimate) %>% kable(digits = 3)
```

\newline

```{r}
bind_rows(M0[["modelObject"]] %>% glance() %>% mutate(model = "Unadjusted") %>% select(model, everything()),
          M[["modelObject"]] %>% glance() %>% mutate(model = "Adjusted") %>% select(model, everything())) %>% 
  kable(digits = 3)
```


### PHQ-2

```{r}
y <- "indPHQ"
M0 <- fitModel(df1, y, x)
table0 <- M0[["modelObject"]] %>% tidy(exponentiate = TRUE) %>% mutate(model = "Unadjusted") %>% select(model, everything())
M <- fitModel(df1, y, x, covar)
table1 <- M[["modelObject"]] %>% tidy(exponentiate = TRUE) %>% mutate(model = "Adjusted") %>% select(model, everything())
bind_rows(table0, table1) %>% rename(oddsratio = estimate) %>% kable(digits = 3)
```

\newline

```{r}
bind_rows(M0[["modelObject"]] %>% glance() %>% mutate(model = "Unadjusted") %>% select(model, everything()),
          M[["modelObject"]] %>% glance() %>% mutate(model = "Adjusted") %>% select(model, everything())) %>% 
  kable(digits = 3)
```


### AUDIT-C

```{r}
y <- "indAuditC"
M0 <- fitModel(df1, y, x)
table0 <- M0[["modelObject"]] %>% tidy(exponentiate = TRUE) %>% mutate(model = "Unadjusted") %>% select(model, everything())
M <- fitModel(df1, y, x, covar)
table1 <- M[["modelObject"]] %>% tidy(exponentiate = TRUE) %>% mutate(model = "Adjusted") %>% select(model, everything())
bind_rows(table0, table1) %>% rename(oddsratio = estimate) %>% kable(digits = 3)
```

\newline

```{r}
bind_rows(M0[["modelObject"]] %>% glance() %>% mutate(model = "Unadjusted") %>% select(model, everything()),
          M[["modelObject"]] %>% glance() %>% mutate(model = "Adjusted") %>% select(model, everything())) %>% 
  kable(digits = 3)
```


### DSI-SS

```{r}
y <- "indDSISS"
M0 <- fitModel(df1, y, x)
table0 <- M0[["modelObject"]] %>% tidy(exponentiate = TRUE) %>% mutate(model = "Unadjusted") %>% select(model, everything())
M <- fitModel(df1, y, x, covar)
table1 <- M[["modelObject"]] %>% tidy(exponentiate = TRUE) %>% mutate(model = "Adjusted") %>% select(model, everything())
bind_rows(table0, table1) %>% rename(oddsratio = estimate) %>% kable(digits = 3)
```

\newline

```{r}
bind_rows(M0[["modelObject"]] %>% glance() %>% mutate(model = "Unadjusted") %>% select(model, everything()),
          M[["modelObject"]] %>% glance() %>% mutate(model = "Adjusted") %>% select(model, everything())) %>% 
  kable(digits = 3)
```
